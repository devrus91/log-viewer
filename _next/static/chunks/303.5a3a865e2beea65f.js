"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[303],{1303:(e,t,a)=>{a.r(t),a.d(t,{default:()=>m});var l=a(5155),n=a(2115),r=a(408),s=a.n(r),i=a(4065),o=a(2502),d=a(7358);function m(){let[e,t]=(0,n.useState)(null),[a,r]=(0,n.useState)([]),[o,d]=(0,n.useState)([]),[m,u]=(0,n.useState)([]),[c,p]=(0,n.useState)(""),[h,x]=(0,n.useState)({start:0,end:0}),g=(0,n.useRef)(null),[b,f]=(0,n.useState)(0),[y,N]=(0,n.useState)(""),v=a.slice(h.start,h.end+1),j=o.map((e,t)=>{var a,l;let n=null!=(l=null==(a=m[t])?void 0:a.hidden)&&l;return{...e,data:e.data.slice(h.start,h.end+1),originalData:e.originalData?e.originalData.slice(h.start,h.end+1):void 0,hidden:n}}),C=0===y.trim().length?m:m.filter(e=>e.label&&e.label.toLowerCase().includes(y.trim().toLowerCase()));return(0,l.jsxs)("div",{className:"w-full py-10",children:[(0,l.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"Upload Car Data Log"}),(0,l.jsxs)("div",{className:"flex items-center gap-4 mb-4",children:[(0,l.jsx)("label",{className:"font-semibold",children:"Skip lines:"}),(0,l.jsx)("input",{type:"number",min:0,value:b,onChange:e=>f(Math.max(0,Number(e.target.value))),className:"border rounded px-2 py-1 w-24"}),(0,l.jsx)("span",{className:"text-gray-500 text-xs",children:"(Number of lines to skip before parsing)"})]}),(0,l.jsx)("input",{type:"file",accept:".csv,.json",onChange:e=>{var a,l;let n=null==(a=e.target.files)?void 0:a[0];if(!n)return;let i=null==(l=n.name.split(".").pop())?void 0:l.toLowerCase();if("csv"===i)s().parse(n,{header:!0,skipEmptyLines:!0,beforeFirstChunk:e=>b>0?e.split(/\r?\n/).slice(b).join("\n"):e,complete:e=>{if(e.data&&e.data.length>0){let a=Object.keys(e.data[0]),l=e.data.map(e=>e[a[0]]),n=a.slice(1).map((t,l)=>{let n="hsl(".concat(360*l/a.length,", 70%, 50%)"),r=e.data.map(e=>{let a=e[t],l="string"==typeof a?parseFloat(a.replace(/,/g,"")):Number(a);return isNaN(l)?null:l}),s=r.filter(e=>"number"==typeof e&&null!==e),i=Math.min(...s),o=Math.max(...s),d=r.map(e=>"number"==typeof e&&null!==e&&o!==i?(e-i)/(o-i)*100:0),m=t.includes("Engine Speed")||t.includes("Boost");return{label:t,data:d,originalData:r,borderColor:n,backgroundColor:n+"80",spanGaps:!0,hidden:!m}});r(l),d(n),u(n.map(e=>({...e}))),t(e.data),x({start:0,end:l.length-1}),p("")}else p("CSV file is empty or invalid.")},error:()=>p("Failed to parse CSV file.")});else if("json"===i){let e=new FileReader;e.onload=e=>{try{var a;let l=JSON.parse(null==(a=e.target)?void 0:a.result);if(Array.isArray(l)&&l.length>0){b>0&&(l=l.slice(b));let e=Object.keys(l[0]),a=l.map(t=>t[e[0]]),n=e.slice(1).map((t,a)=>{let n="hsl(".concat(360*a/e.length,", 70%, 50%)"),r=l.map(e=>{let a=e[t],l="string"==typeof a?parseFloat(a.replace(/,/g,"")):Number(a);return isNaN(l)?null:l}),s=r.filter(e=>"number"==typeof e&&null!==e),i=Math.min(...s),o=Math.max(...s),d=r.map(e=>"number"==typeof e&&null!==e&&o!==i?(e-i)/(o-i)*100:0),m=t.includes("Engine Speed")||t.includes("Boost");return{label:t,data:d,originalData:r,borderColor:n,backgroundColor:n+"80",spanGaps:!0,hidden:!m}});r(a),d(n),u(n.map(e=>({...e}))),t(l),x({start:0,end:a.length-1}),p("")}else p("JSON file is empty or invalid.")}catch(e){p("Failed to parse JSON file.")}},e.readAsText(n)}else p("Unsupported file type. Please upload a CSV or JSON file.")},className:"mb-6"}),c&&(0,l.jsx)("div",{className:"text-red-500 mb-4",children:c}),a.length>0&&o.length>0&&(0,l.jsxs)("div",{className:"w-full overflow-x-auto bg-white rounded shadow p-4 mb-8",children:[(0,l.jsxs)("div",{className:"mb-2 flex items-center gap-2 w-full",children:[(0,l.jsx)("input",{type:"text",value:y,onChange:e=>N(e.target.value),placeholder:"Search labels...",className:"border rounded px-2 py-1 w-full max-w-xl text-sm placeholder-gray-700 text-gray-900"}),y&&(0,l.jsx)("button",{onClick:()=>N(""),className:"ml-1 px-2 py-1 text-xs bg-gray-200 rounded hover:bg-gray-300",children:"Clear"})]}),(0,l.jsxs)("div",{className:"max-h-40 overflow-y-auto mb-4 border rounded p-2 bg-gray-50 flex flex-wrap gap-2 w-full",children:[0===C.length&&(0,l.jsx)("span",{className:"text-gray-400 text-xs",children:"No labels found"}),C.map((e,t)=>{let a=m.findIndex(t=>t.label===e.label),n="string"==typeof e.borderColor?e.borderColor:"#888";return(0,l.jsxs)("button",{className:"flex items-center gap-2 px-2 py-1 rounded text-xs font-medium border ".concat(e.hidden?"bg-gray-200 text-gray-400":"bg-white"," "),style:{borderColor:n,color:n},onClick:()=>u(e=>e.map((e,t)=>t===a?{...e,hidden:!e.hidden}:e)),type:"button",children:[(0,l.jsx)("span",{className:"inline-block w-3 h-3 rounded-full mr-1",style:{background:n,opacity:e.hidden?.3:1}}),e.label]},e.label)})]}),(0,l.jsxs)("div",{className:"flex items-center gap-4 mb-4 w-full flex-wrap",children:[(0,l.jsx)("label",{className:"font-semibold",children:"Start index:"}),(0,l.jsx)("input",{type:"number",min:0,max:a.length-1,value:h.start,onChange:e=>x(t=>({...t,start:Math.max(0,Math.min(Number(e.target.value),t.end))})),className:"border rounded px-2 py-1 w-24"}),(0,l.jsx)("label",{className:"font-semibold",children:"End index:"}),(0,l.jsx)("input",{type:"number",min:h.start,max:a.length-1,value:h.end,onChange:e=>x(t=>({...t,end:Math.min(a.length-1,Math.max(Number(e.target.value),t.start))})),className:"border rounded px-2 py-1 w-24"}),(0,l.jsxs)("span",{className:"text-gray-500",children:["(0 to ",a.length-1,")"]}),(0,l.jsx)("button",{onClick:()=>{g.current&&(g.current.resetZoom&&g.current.resetZoom(),x({start:0,end:a.length-1}))},className:"ml-4 px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Reset Zoom"}),(0,l.jsx)("span",{className:"text-xs text-blue-600",children:"Tip: Ctrl+drag on chart to select index range"})]}),(0,l.jsx)("div",{style:{height:500,width:"100%",position:"relative"},className:"w-full",children:(0,l.jsx)(i.N1,{ref:g,data:{labels:v,datasets:j},options:{responsive:!0,maintainAspectRatio:!1,animation:!1,interaction:{mode:"index",intersect:!1},plugins:{legend:{display:!1},title:{display:!0,text:"Car Data Chart"},zoom:{pan:{enabled:!0,mode:"xy"},zoom:{wheel:{enabled:!0},pinch:{enabled:!0},drag:{enabled:!0,modifierKey:"ctrl"},mode:"xy",onZoom:e=>{if((null==e?void 0:e.trigger)==="drag"){let t=e.chart.scales.x;if(t&&"number"==typeof t.left&&"number"==typeof t.right){let e=t.getValueForPixel(t.left),l=t.getValueForPixel(t.right);if("number"==typeof e&&"number"==typeof l){let t=Math.max(0,Math.round(e)),n=Math.min(a.length-1,Math.round(l));x({start:Math.min(t,n),end:Math.max(t,n)}),console.log("Zoomed to range: ".concat(t," - ").concat(n))}}}}},limits:{x:{minRange:5},y:{minRange:.1}}},tooltip:{callbacks:{label:function(e){let t=e.chart,a=e.datasetIndex;if(t.getDatasetMeta(a).hidden)return null;let l=e.dataset,n=e.dataIndex,r=l.originalData&&null!=l.originalData[n]?l.originalData[n]:null,s=l.label||"";return null!==r&&(s+=": ".concat(r)),s}}},decimation:{enabled:!0,algorithm:"lttb",samples:500}},scales:{x:{ticks:{autoSkip:!1,maxRotation:90,minRotation:45,font:{size:12}}},y:{ticks:{font:{size:14}}}}}})})]})]})}o.t1.register(o.PP,o.kc,o.FN,o.No,o.hE,o.m_,o.s$,d.Ay)}}]);